<div class="container mt-4">
	<p>This page allows to manage esp device.</p>
    <div class="card">
        <div class="card-header">Restart</div>
        <div class="card-body">
            <p>Use this command to restart esp device and apply new settings.</p>
            <button type="button" class="btn btn-danger mt-2" onclick="restart();">Restart</button>
        </div>
    </div>
    <div class="card mt-2">
        <div class="card-header">Settings</div>
        <div class="card-body">
            <p>Use this command to reset esp device settings.</p>
            <p>On next reboot esp device will not connect to wifi. Instead it'll create a default AP.</p>
            <button type="button" class="btn btn-danger mt-2" onclick="clearSettings();">Reset settings and restart</button>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6 mt-2">
            <div class="card">
                <div class="card-header">Device logging</div>
                <div class="card-body">
                    <p>Current logging file size: <strong>{logs_size}</strong></p>
                    <button type="button" class="btn btn-primary" onclick="downloadLogs();">Download logs</button>
                    <p class="mt-4">Use this command to clear logs file.</p>
                    <button type="button" class="btn btn-danger" onclick="clearLogs();">Clear logs</button>
                </div>
            </div>
        </div>
        <div class="col-md-6 mt-2">
            <div class="card">
                <div class="card-header">Device statistics</div>
                <div class="card-body">
                    <p>Current statistics file size: <strong>{statistics_size}</strong></p>
                    <button type="button" class="btn btn-primary" onclick="downloadStatistics();">Download db</button>
                    <p class="mt-4">Use this command to clear statistics file.</p>
                    <button type="button" class="btn btn-danger" onclick="clearStatistics();">Clear db</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
function restart() {
    executeCall("/restart", "POST").then((updOk) => {
        if (updOk == true) {
            openModal("Done", "esp device is restarting");
        }
    });
}
function clearSettings() {
    executeCall("/settings", "DELETE").then((updOk) => {
        if (updOk == true) {
            openModal("Done", "Successfully removed current settings");
        }
    });
}
function downloadLogs() {
    window.location.assign("/logs");
}
function clearLogs() {
    executeCall("/logs", "DELETE").then((updOk) => {
        if (updOk == true) {
            document.location.reload(true);
        }
    });
}
function downloadStatistics() {
    window.location.assign("/statistics/download");
}
function clearStatistics() {
    executeCall("/statistics", "DELETE").then((updOk) => {
        if (updOk == true) {
            document.location.reload(true);
        }
    });
}
</script>